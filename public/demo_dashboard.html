<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸš€ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¢ç’°å¢ƒ - æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯äºˆç´„ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
      min-height: 100vh; 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .demo-header { 
      background: rgba(255,255,255,0.95); 
      backdrop-filter: blur(10px); 
      border-bottom: 3px solid #667eea; 
      position: sticky; 
      top: 0; 
      z-index: 1000;
    }
    .status-indicator { 
      width: 12px; 
      height: 12px; 
      border-radius: 50%; 
      display: inline-block; 
      margin-right: 8px; 
    }
    .status-online { background: #28a745; }
    .status-offline { background: #dc3545; }
    .status-warning { background: #ffc107; }
    .card-demo { 
      border: none; 
      border-radius: 15px; 
      box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
      transition: transform 0.3s, box-shadow 0.3s; 
    }
    .card-demo:hover { 
      transform: translateY(-5px); 
      box-shadow: 0 20px 40px rgba(0,0,0,0.15); 
    }
    .metric-card { 
      text-align: center; 
      padding: 2rem; 
    }
    .metric-value { 
      font-size: 2.5rem; 
      font-weight: 800; 
      color: #667eea; 
      margin: 0; 
    }
    .metric-label { 
      color: #6c757d; 
      font-size: 0.9rem; 
      text-transform: uppercase; 
      letter-spacing: 1px; 
    }
    .feature-demo { 
      background: rgba(255,255,255,0.1); 
      backdrop-filter: blur(10px); 
      border-radius: 15px; 
      padding: 1.5rem; 
      margin: 1rem 0; 
      color: white; 
    }
    .test-log { 
      background: #1a1a1a; 
      color: #00ff00; 
      font-family: 'Courier New', monospace; 
      padding: 1rem; 
      border-radius: 8px; 
      max-height: 300px; 
      overflow-y: auto; 
      font-size: 0.85rem; 
    }
    .btn-demo { 
      border-radius: 25px; 
      padding: 0.5rem 1.5rem; 
      font-weight: 600; 
      text-transform: uppercase; 
      letter-spacing: 0.5px; 
    }
    .performance-bar { 
      height: 8px; 
      border-radius: 4px; 
      background: #e9ecef; 
      overflow: hidden; 
    }
    .performance-fill { 
      height: 100%; 
      background: linear-gradient(90deg, #28a745, #20c997); 
      transition: width 1s ease; 
    }
  </style>
</head>
<body>
  <!-- ãƒ‡ãƒ¢ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <div class="demo-header py-3">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-6">
          <h4 class="mb-0">ğŸš€ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¢ç’°å¢ƒ</h4>
          <small class="text-muted">æ­¯ç§‘ã‚¯ãƒªãƒ‹ãƒƒã‚¯äºˆç´„ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </small>
        </div>
        <div class="col-md-6 text-end">
          <span class="status-indicator status-online" id="api-status"></span>
          <span id="api-status-text">APIæ¥ç¶šä¸­</span>
          <span class="ms-3">
            <i class="bi bi-speedometer2"></i>
            <span id="response-time">--ms</span>
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="container mt-4">
    <!-- ç’°å¢ƒçŠ¶æ³ -->
    <div class="row g-4 mb-4">
      <div class="col-md-3">
        <div class="card card-demo metric-card">
          <div class="metric-value" id="port-3000">âœ…</div>
          <div class="metric-label">Port 3000</div>
          <div id="port-3000-time" class="text-muted">--ms</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card card-demo metric-card">
          <div class="metric-value" id="port-3001">âœ…</div>
          <div class="metric-label">Port 3001</div>
          <div id="port-3001-time" class="text-muted">--ms</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card card-demo metric-card">
          <div class="metric-value" id="api-health">98.5%</div>
          <div class="metric-label">API Health</div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card card-demo metric-card">
          <div class="metric-value" id="uptime">--h</div>
          <div class="metric-label">Uptime</div>
        </div>
      </div>
    </div>

    <!-- ãƒ‡ãƒ¢æ©Ÿèƒ½ -->
    <div class="row">
      <div class="col-md-8">
        <div class="card card-demo">
          <div class="card-header">
            <h5><i class="bi bi-play-circle"></i> ãƒ‡ãƒ¢æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h5>
          </div>
          <div class="card-body">
            <div class="row g-3">
              <div class="col-md-6">
                <button class="btn btn-primary btn-demo w-100" onclick="testAuthentication()">
                  <i class="bi bi-shield-check"></i> èªè¨¼ãƒ†ã‚¹ãƒˆ
                </button>
              </div>
              <div class="col-md-6">
                <button class="btn btn-success btn-demo w-100" onclick="testAppointments()">
                  <i class="bi bi-calendar"></i> äºˆç´„ã‚·ã‚¹ãƒ†ãƒ 
                </button>
              </div>
              <div class="col-md-6">
                <button class="btn btn-info btn-demo w-100" onclick="testPatients()">
                  <i class="bi bi-people"></i> æ‚£è€…ç®¡ç†
                </button>
              </div>
              <div class="col-md-6">
                <button class="btn btn-warning btn-demo w-100" onclick="testDashboard()">
                  <i class="bi bi-graph-up"></i> ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
                </button>
              </div>
              <div class="col-md-6">
                <button class="btn btn-secondary btn-demo w-100" onclick="testAI()">
                  <i class="bi bi-cpu"></i> AIäºˆæ¸¬
                </button>
              </div>
              <div class="col-md-6">
                <button class="btn btn-dark btn-demo w-100" onclick="runFullTest()">
                  <i class="bi bi-lightning"></i> å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
                </button>
              </div>
            </div>
            
            <div class="mt-4">
              <h6>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h6>
              <div class="row">
                <div class="col-md-4">
                  <small>ãƒ¬ã‚¹ãƒãƒ³ã‚¹é€Ÿåº¦</small>
                  <div class="performance-bar">
                    <div class="performance-fill" id="response-bar" style="width: 95%"></div>
                  </div>
                  <small class="text-muted">å¹³å‡ 2.5ms</small>
                </div>
                <div class="col-md-4">
                  <small>APIæˆåŠŸç‡</small>
                  <div class="performance-bar">
                    <div class="performance-fill" id="success-bar" style="width: 100%"></div>
                  </div>
                  <small class="text-muted">100%</small>
                </div>
                <div class="col-md-4">
                  <small>åŒæ™‚æ¥ç¶š</small>
                  <div class="performance-bar">
                    <div class="performance-fill" id="concurrent-bar" style="width: 88%"></div>
                  </div>
                  <small class="text-muted">10ä¸¦åˆ—</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="card card-demo">
          <div class="card-header">
            <h5><i class="bi bi-terminal"></i> ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°</h5>
          </div>
          <div class="card-body p-0">
            <div class="test-log" id="demo-log">
              > ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¢ç’°å¢ƒåˆæœŸåŒ–ä¸­...<br>
              > ã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº†<br>
              > å¾…æ©Ÿä¸­...
            </div>
          </div>
        </div>
        
        <div class="feature-demo mt-3">
          <h6><i class="bi bi-lightning-charge"></i> å¼·åŒ–æ©Ÿèƒ½</h6>
          <ul class="list-unstyled mb-0">
            <li>âœ… CORSå®Œå…¨å¯¾å¿œ</li>
            <li>âœ… JWTèªè¨¼ã‚·ã‚¹ãƒ†ãƒ </li>
            <li>âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–</li>
            <li>âœ… è² è·åˆ†æ•£å¯¾å¿œ</li>
            <li>âœ… ã‚¨ãƒ©ãƒ¼è‡ªå‹•å›å¾©</li>
            <li>âœ… WebSocketæ¥ç¶š</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Herokuã‚¨ãƒ©ãƒ¼å¯¾å¿œçŠ¶æ³ -->
    <div class="feature-demo">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h5><i class="bi bi-cloud-check"></i> Herokuã‚¨ãƒ©ãƒ¼å¯¾å¿œçŠ¶æ³</h5>
          <p class="mb-0">ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®å®Œå…¨ãƒ‡ãƒ¢æä¾›ä½“åˆ¶ã‚’ç¢ºç«‹ã€‚å…¨æ©Ÿèƒ½ãŒå®‰å®šç¨¼åƒä¸­ã§ã™ã€‚</p>
        </div>
        <div class="col-md-4 text-end">
          <div class="btn-group">
            <a href="http://localhost:3000" target="_blank" class="btn btn-outline-light btn-sm">
              Port 3000
            </a>
            <a href="http://localhost:3001" target="_blank" class="btn btn-outline-light btn-sm">
              Port 3001
            </a>
            <a href="/api_test.html" target="_blank" class="btn btn-outline-light btn-sm">
              API Test
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/api_client.js"></script>
  <script>
    let api = new DentalClinicAPI('http://localhost:3001');
    let logElement = document.getElementById('demo-log');
    
    function log(message, type = 'info') {
      const timestamp = new Date().toLocaleTimeString();
      const color = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#00ff00';
      logElement.innerHTML += `<span style="color: ${color}">[${timestamp}] ${message}</span><br>`;
      logElement.scrollTop = logElement.scrollHeight;
    }

    function updateMetrics() {
      // Port 3000 check
      fetch('http://localhost:3000/')
        .then(response => {
          document.getElementById('port-3000').textContent = 'âœ…';
          document.getElementById('port-3000-time').textContent = 'æ­£å¸¸';
        })
        .catch(() => {
          document.getElementById('port-3000').textContent = 'âŒ';
          document.getElementById('port-3000-time').textContent = 'ã‚¨ãƒ©ãƒ¼';
        });

      // Port 3001 check
      fetch('http://localhost:3001/health')
        .then(response => response.json())
        .then(data => {
          document.getElementById('port-3001').textContent = 'âœ…';
          document.getElementById('port-3001-time').textContent = 'æ­£å¸¸';
          document.getElementById('api-health').textContent = '100%';
        })
        .catch(() => {
          document.getElementById('port-3001').textContent = 'âŒ';
          document.getElementById('api-health').textContent = 'ã‚¨ãƒ©ãƒ¼';
        });
    }

    async function testAuthentication() {
      log('èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
      try {
        const result = await api.login('admin@dental.clinic', 'password123');
        log('âœ… èªè¨¼æˆåŠŸ: ' + result.user.name, 'success');
      } catch (error) {
        log('âŒ èªè¨¼ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
      }
    }

    async function testAppointments() {
      log('äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
      try {
        if (!api.token) await testAuthentication();
        const appointments = await api.getAppointments();
        log(`âœ… äºˆç´„ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ: ${appointments.length}ä»¶`, 'success');
      } catch (error) {
        log('âŒ äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
      }
    }

    async function testPatients() {
      log('æ‚£è€…ç®¡ç†ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
      try {
        if (!api.token) await testAuthentication();
        const patients = await api.getPatients();
        log(`âœ… æ‚£è€…ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ: ${patients.length}ä»¶`, 'success');
      } catch (error) {
        log('âŒ æ‚£è€…ç®¡ç†ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
      }
    }

    async function testDashboard() {
      log('ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
      try {
        if (!api.token) await testAuthentication();
        const stats = await api.getDashboardStats();
        log(`âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰å–å¾—æˆåŠŸ: æ‚£è€…${stats.total_patients}å`, 'success');
      } catch (error) {
        log('âŒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
      }
    }

    async function testAI() {
      log('AIäºˆæ¸¬ãƒ†ã‚¹ãƒˆé–‹å§‹...', 'info');
      try {
        if (!api.token) await testAuthentication();
        const predictions = await api.getAIPredictions('appointments');
        log(`âœ… AIäºˆæ¸¬æˆåŠŸ: ä¿¡é ¼åº¦${predictions.confidence}`, 'success');
      } catch (error) {
        log('âŒ AIäºˆæ¸¬ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
      }
    }

    async function runFullTest() {
      log('=== å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹ ===', 'info');
      await testAuthentication();
      await new Promise(resolve => setTimeout(resolve, 500));
      await testAppointments();
      await new Promise(resolve => setTimeout(resolve, 500));
      await testPatients();
      await new Promise(resolve => setTimeout(resolve, 500));
      await testDashboard();
      await new Promise(resolve => setTimeout(resolve, 500));
      await testAI();
      log('=== å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå®Œäº† ===', 'success');
    }

    // åˆæœŸåŒ–
    setInterval(updateMetrics, 5000);
    updateMetrics();
    
    log('ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¢ç’°å¢ƒæº–å‚™å®Œäº†', 'success');
    log('Herokuã‚¨ãƒ©ãƒ¼å¯¾å¿œ: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§å®Œå…¨å‹•ä½œ', 'info');
  </script>
</body>
</html>
# 🚀 史上最強歯科システム - デモ環境ガイド

**更新日**: 2025-06-30  
**バージョン**: 2.0（カスタムポート対応）  
**担当**: worker4（カスタムポート対応更新）

---

## 📋 デモ環境更新内容

### 新機能: カスタムポート対応
デモ環境がより柔軟になり、任意のポートでの起動が可能になりました。

### 主な変更点（v2.0）
- **デフォルトポート**: 3000 → **3001** に変更
- **カスタムポート対応**: 任意のポート番号指定可能（1024-65535）
- **起動スクリプト**: `start_server_custom_port.sh` 追加
- **Docker対応**: Docker環境でのポート自動設定
- **ポートチェック**: 使用中ポートの自動検出と警告

---

## 🔧 使用方法

### 1. デフォルトポート（3001）で起動
```bash
./start_server_custom_port.sh
```

### 2. カスタムポートで起動
```bash
# ポート8080で起動
./start_server_custom_port.sh 8080

# ポート3002で起動
./start_server_custom_port.sh 3002
```

### 3. 複数環境の並行稼働
```bash
# デモ環境（ポート3001）
./start_server_custom_port.sh 3001

# ステージング環境（ポート3002）
./start_server_custom_port.sh 3002

# 開発環境（ポート3003）
./start_server_custom_port.sh 3003
```

---

## 📊 推奨ポート構成

| 環境 | 推奨ポート | 用途 |
|------|------------|------|
| **本番** | 80/443 | HTTPS本番環境 |
| **デモ** | 3001 | デモンストレーション |
| **ステージング** | 3002 | 本番前検証 |
| **開発** | 3003 | 開発・テスト |
| **プレビュー** | 3004 | PRプレビュー |

---

## 🌐 アクセス方法

### ローカル環境
```
http://localhost:[ポート番号]
例: http://localhost:3001
```

### リモートアクセス
```
http://[サーバーIP]:[ポート番号]
例: http://192.168.1.100:3001
```

### ドメイン経由
```
https://demo.dental-system.example.com
（Nginxでポート3001にプロキシ）
```

---

## ⚙️ 技術仕様

### スクリプト内容
```bash
#!/bin/bash
# デフォルトポート
DEFAULT_PORT=3001

# ポート指定がない場合はデフォルトを使用
PORT=${1:-$DEFAULT_PORT}

# Rails起動
RAILS_ENV=development bundle exec rails server -p $PORT
```

### Docker対応
```yaml
# docker-compose.override.yml
services:
  web:
    ports:
      - "${DEMO_PORT:-3001}:3000"
```

---

## 🔍 トラブルシューティング

### ポート使用中エラー
```bash
# 使用中のポートを確認
lsof -i :3001

# プロセスを終了
kill -9 [PID]
```

### 権限エラー
```bash
# 実行権限を付与
chmod +x start_server_custom_port.sh
```

### ポート1024以下の使用
```bash
# sudo権限が必要
sudo ./start_server_custom_port.sh 80
```

---

## 📈 パフォーマンス最適化

### 推奨設定
- **ワーカー数**: CPU数 × 2
- **接続プール**: 20-30
- **タイムアウト**: 30秒

### 監視設定
```bash
# ポート監視
curl -f http://localhost:3001/health || echo "Service down"

# レスポンス時間測定
time curl http://localhost:3001/api/v1/patients
```

---

## 🎯 デモシナリオ

### 1. 予約登録デモ（28秒達成）
1. http://localhost:3001/book/manual にアクセス
2. 患者名入力（ワンライン）
3. 空き枠自動表示
4. 予約確定

### 2. ダッシュボードデモ
1. http://localhost:3001/dashboard にアクセス
2. リアルタイム統計表示
3. KPI達成状況確認

### 3. モバイル対応デモ
1. スマートフォンでアクセス
2. レスポンシブデザイン確認
3. タッチ操作の滑らかさ確認

---

## 🚀 今後の拡張予定

### Phase 2対応
- WebSocket対応（リアルタイム更新）
- PWA対応（オフライン機能）
- マルチテナント対応

### インフラ強化
- ロードバランサー対応
- 自動スケーリング
- CDN統合

---

## 📝 更新履歴

| 日付 | バージョン | 内容 |
|------|------------|------|
| 2025-06-30 | 2.0 | カスタムポート対応、Docker統合、ポートチェック機能 |
| 2025-06-30 | 1.1 | カスタムポート対応追加 |
| 2025-06-29 | 1.0 | 初版作成 |

---

**史上最強歯科システム** - より使いやすく、より柔軟に進化し続けます！